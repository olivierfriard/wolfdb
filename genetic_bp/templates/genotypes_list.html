{% extends "bootstrap_simple.html" %}

{% block content %}


<h1>WolfDB</h1>
<hr>

<a href="/" class="btn btn-primary">Home</a>&nbsp;
<a href="/genotypes" class="btn btn-primary">Genotypes</a>&nbsp;

<a href="/genotypes_list/all{{ short }}" class="btn btn-primary">All</a>&nbsp;

<a href="/genotypes_list/definitive{{ short }}" class="btn btn-primary">Definitive</a>&nbsp;

<a href="/genotypes_list/temp{{ short }}" class="btn btn-primary">Temporary</a>&nbsp;

<br>
<br>


{% if results %}
<h2>{{ title }}</h2>


<br><a href="/genotypes_list/{{type }}/export" class="btn btn-info">Export data in XLSX format</a><br>
<br>

<style>th {top:0;position:sticky;}</style>

<table class="table table-striped">
<tr>
<th style="background-color: white;"></th>
<th style="background-color: white;"></th>
<th style="background-color: white;">Genotype ID</th>
<th style="background-color: white;">Notes</th>
<th style="background-color: white;">Other ID</th>
<th style="background-color: white;">Date</th>
<th style="background-color: white;">Pack</th>
<th style="background-color: white;">Sex</th>
<th style="background-color: white;">Hybrid</th>
<th style="background-color: white;">Status</th>
<th style="background-color: white;">Age first capture</th>
<th style="background-color: white;">Status first capture</th>
<th style="background-color: white;">Dispersal</th>
<th style="background-color: white;">N recap.</th>
<th style="background-color: white;">Dead recovery</th>


{% if loci_list %}

{% for locus in loci_list %}
{% if loci_list[locus] == 2%}
<th style="background-color: white; border-left: 1px solid black;">{{ locus }} a</th>
<th style="background-color: white;">{{ locus }} b</th>
{% else %}
<th style="background-color: white; border-left: 1px solid black;">{{ locus }}</th>
<th style="background-color: white;"></th>
{% endif %}

{% endfor %}

{% endif %}

</tr>
{% for result in results %}

<tr>
<td>
<div class="dropdown">
<button class="btn btn-secondary btn-sm dropdown-toggle" type="button" id="dropdownMenuButton1" data-bs-toggle="dropdown" aria-expanded="false">
set ...
</button>
<ul class="dropdown-menu" aria-labelledby="dropdownMenuButton1">
<li><a href="/set_status/{{ result['genotype_id'] }}" class="dropdown-item">status</a></li>
<li><a href="/set_pack/{{ result['genotype_id'] }}" class="dropdown-item">pack</a></li>
<li><a href="/set_sex/{{ result['genotype_id'] }}" class="dropdown-item">sex</a></li>
<li><a href="/set_hybrid/{{ result['genotype_id'] }}" class="dropdown-item">hybrid</a></li>
<li><a href="/set_status_1st_recap/{{ result['genotype_id'] }}" class="dropdown-item">status at 1st recap</a></li>
<li><a href="/set_dispersal/{{ result['genotype_id'] }}" class="dropdown-item">dispersal</a></li>
<li><a href="/genotype_note/{{ result['genotype_id'] }}" class="dropdown-item">notes</a></li>
</ul>
</div>
</td>
<td>
{% if type != "deleted" %}
<a href="/del_genotype/{{ result['genotype_id'] }}" class="btn btn-danger btn-sm" onclick="return confirm('Are you sure to delete this genotype?')">Delete</a>
{% else %}
<a href="/def_genotype/{{ result['genotype_id'] }}" class="btn btn-danger btn-sm" onclick="return confirm('Are you sure to set this genotype definitive?')">Set definitive</a>
<a href="/temp_genotype/{{ result['genotype_id'] }}" class="btn btn-danger btn-sm" onclick="return confirm('Are you sure to set this genotype temporary?')">Set temporary</a>
{% endif %}
</td>

<td><a href="/view_genotype/{{ result['genotype_id'] }}" >{{ result['genotype_id'] }}</a></td>

<td>{% if result['working_notes'] %}{{ result['working_notes'] }}{% endif %}</td>

<td><a href="/view_genotype/{{ result['tmp_id'] }}" >{{ result['tmp_id'] }}</a></td>

<td>{% if result['date'] %}{{ result['date'] }}{% endif %}</td>

<td>{% if result['pack'] %}{{ result['pack'] }}{% endif %}</td>

<td>{% if result['sex'] %}{{ result['sex'] }}{% endif %}</td>

<td>{% if result['hybrid'] %}{{ result['hybrid'] }}{% endif %}</td>

<td>{% if result['position'] %}{{ result['position'] }}{% endif %}</td>

<td>{% if result['age_first_capture'] %}{{ result['age_first_capture'] }}{% endif %}</td>

<td>{{ result['status_first_capture'] if result['status_first_capture'] is not none else ""}}</td>

<td>{% if result['dispersal'] %}{{ result['dispersal'] }}{% endif %}</td>

<td>{% if result['n_recaptures'] %}{{ result['n_recaptures'] }}{% endif %}</td>

<td>{% if result['dead_recovery'] %}{{ result['dead_recovery'] }}{% endif %}</td>

{% if loci_list %}
{% for locus in loci_values[result['genotype_id']] %}
<td style="border-left: 1px solid black; {% if 'OK|' in loci_values[result['genotype_id']][locus]['a']['user_id'] %}background: #90ee90{%else%}{% if loci_values[result['genotype_id']][locus]['a']['notes'] %}background: #FF6461{%endif%}{%endif%}">
{{ loci_values[result['genotype_id']][locus]['a']['value'] }}
<br>
<small><a href="/genotype_locus_note/{{ result['genotype_id']}}/{{ locus }}/a/{{ loci_values[result['genotype_id']][locus]['a']['epoch'] }}">note</a></small>
</td>

<td style="{% if 'OK|' in loci_values[result['genotype_id']][locus]['b']['user_id'] %}background: #90ee90{%else%}{% if loci_values[result['genotype_id']][locus]['b']['notes'] %}background: #FF6461{%endif%}{%endif%}">
{{ loci_values[result['genotype_id']][locus]['b']['value'] }}

<br>
<small><a href="/genotype_locus_note/{{ result['genotype_id']}}/{{ locus }}/b/{{ loci_values[result['genotype_id']][locus]['b']['epoch'] }}">note</a></small>
</td>
{% endfor %}
{% endif %}
</tr>
{% endfor %}

</table>
{% else %}

<h2>No genotypes found</h2>

{% endif %}


{% endblock %}