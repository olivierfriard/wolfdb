{% extends "bootstrap_simple.html" %}

{% block content %}


<h1>WolfDB</h1>
<hr>

<a href="/" class="btn btn-primary">Home</a>&nbsp;

<a href="/genetic_samples" class="btn btn-primary">WA genetic samples</a>&nbsp;

<a href="/plot_all_wa" class="btn btn-primary">Plot WA</a>&nbsp;

<a href="/plot_wa_clusters/{{ distance }}" class="btn btn-primary">Plot WA clusters ({{ distance }} m)</a>&nbsp;

<br>
<br>


{% with messages = get_flashed_messages() %}
    {% if messages %}
        {{ messages[0] }}
    {% endif %}
{% endwith %}


{% if genotype_id %}

{{ title }}

<br><a href="/wa_analysis_group/export/{{ distance }}/{{ cluster_id }}" class="btn btn-info">Export data</a><br>
<br>

<style>th {top:0;position:sticky;}</style>

<table class="table table-striped">
<tr>
<th style="background-color: white;"></th>

<th style="background-color: white;">Genotype ID</th>
<th style="background-color: white;">Notes</th>
<th style="background-color: white;">Temp ID</th>
<th style="background-color: white;">Sex</th>
<th style="background-color: white;">Status</th>
<th style="background-color: white;">Pack</th>
<th style="background-color: white;">Hybrid</th>
<th style="background-color: white;">Dispersal</th>
<th style="background-color: white;">n. recapt</th>
<th style="background-color: white;">Dead recovery</th>

{% for locus in loci_list %}
{% if loci_list[locus] == 2%}
<th style="background-color: white; border-left: 1px solid black;">{{ locus }} a</th>
<th style="background-color: white;">{{ locus }} b</th>
{% else %}
<th style="background-color: white; border-left: 1px solid black;">{{ locus }}</th>
<th style="background-color: white;"></th>
{% endif %}

{% endfor %}


</tr>
{% for genotype_id in data %}

<tr>

<td>
<div class="dropdown">
<button class="btn btn-secondary btn-sm dropdown-toggle" type="button" id="dropdownMenuButton1" data-bs-toggle="dropdown" aria-expanded="false">
set ...
</button>
<ul class="dropdown-menu" aria-labelledby="dropdownMenuButton1">
<li><a href="/set_status/{{ genotype_id }}" class="dropdown-item">status</a></li>
<li><a href="/set_pack/{{ genotype_id }}" class="dropdown-item">pack</a></li>
<li><a href="/set_sex/{{ genotype_id }}" class="dropdown-item">sex</a></li>
<li><a href="/set_hybrid/{{ genotype_id }}" class="dropdown-item">hybrid</a></li>
<li><a href="/set_status_1st_recap/{{ genotype_id }}" class="dropdown-item">status at 1st recap</a></li>
<li><a href="/set_dispersal/{{ genotype_id }}" class="dropdown-item">dispersal</a></li>
<li><a href="/genotype_note/{{ genotype_id }}" class="dropdown-item">notes</a></li>
</ul>
</div>


</td>

<td><a href="/view_genotype/{{ genotype_id }}" target="_blank">{{ genotype_id }}</a></td>

<td>{{ data[genotype_id]["working_notes"] if data[genotype_id]["working_notes"] is not none else "" }}</td>

<td>{{ data[genotype_id]["tmp_id"] }}</td>

<td>{{ data[genotype_id]["sex"] }}</td>

<td>{{ data[genotype_id]["status"] if data[genotype_id]["status"] is not none else "" }}</td>

<td>{{ data[genotype_id]["pack"] if data[genotype_id]["pack"] is not none else "" }}</td>


<td>{{ data[genotype_id]["hybrid"] if data[genotype_id]["hybrid"] is not none else "" }}</td>

<td>{{ data[genotype_id]["dispersal"] if data[genotype_id]["dispersal"] is not none else "" }}</td>

<td>{{ data[genotype_id]["n_recap"] if data[genotype_id]["n_recap"] is not none else "" }}</td>

<td>{{ data[genotype_id]["dead_recovery"] if data[genotype_id]["dead_recovery"] is not none else "" }}</td>


{% for locus in loci_values[genotype_id] %}

<td style="border-left: 1px solid black; {% if 'OK|' in loci_values[genotype_id][locus]['a']['user_id'] %}background: #90ee90{%else%}{% if loci_values[genotype_id][locus]['a']['notes'] %}background: #FF6461{%endif%}{%endif%}">
{{ loci_values[genotype_id][locus]['a']['value'] }}
<br>
<small>
<a href="/genotype_locus_note/{{ genotype_id}}/{{ locus }}/a/{{ loci_values[genotype_id][locus]['a']['epoch'] }}">note</a>
</small>
</td>


<td style="{% if 'OK|' in loci_values[genotype_id][locus]['b']['user_id'] %}background: #90ee90{% else %}{% if loci_values[genotype_id][locus]['b']['notes'] %}background: #FF6461{%endif%}{% endif %}">
{{ loci_values[genotype_id][locus]['b']['value'] }}
<br>
<small>
<a href="/genotype_locus_note/{{ genotype_id }}/{{ locus }}/b/{{ loci_values[genotype_id][locus]['b']['epoch'] }}">note</a>
</small>
</td>

{% endfor %}

</tr>
{% endfor %}

</table>
{% else %}

<h2>No WA code found</h2>

{% endif %}

{% endblock %}





